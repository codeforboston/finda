/*! Flight v1.1.2 | (c) Twitter, Inc. | MIT License */
!function(t){function n(){var t,n,e=Array.prototype.slice.call(arguments),o=[];"string"==typeof e[0]&&(t=e.shift()),r(e[0])&&(o=e.shift()),n=e.shift(),i[t]=[o,n]}function e(t){function n(n){var e=t.split("/"),i=n.split("/"),o=!1;for(e.pop();".."==i[0]&&e.length;)e.pop(),i.shift(),o=!0;return"."==i[0]&&(i.shift(),o=!0),o&&(i=e.concat(i)),i.join("/")}var r,a,c;return"undefined"==typeof o[t]&&(r=i[t],r&&(c=r[0],a=r[1],o[t]=a.apply(void 0,s(c,function(t){return e(n(t))})))),o[t]}var i={},o={},r=Array.isArray||function(t){return t.constructor==Array},s=Array.map||function(t,n,e){for(var i=0,o=t.length,r=[];o>i;i++)r.push(n.call(e,t[i]));return r};n("lib/utils",[],function(){"use strict";var t=[],n=100,e={isDomObj:function(t){return!(!t.nodeType&&t!==window)},toArray:function(n,e){return t.slice.call(n,e)},merge:function(){for(var t=arguments.length,n=0,e=new Array(t+1);t>n;n++)e[n+1]=arguments[n];return 0===t?{}:(e[0]={},e[e.length-1]===!0&&(e.pop(),e.unshift(!0)),$.extend.apply(void 0,e))},push:function(t,n,e){return t&&Object.keys(n||{}).forEach(function(i){if(t[i]&&e)throw new Error('utils.push attempted to overwrite "'+i+'" while running in protected mode');"object"==typeof t[i]&&"object"==typeof n[i]?this.push(t[i],n[i]):t[i]=n[i]},this),t},isEnumerable:function(t,n){return Object.keys(t).indexOf(n)>-1},compose:function(){var t=arguments;return function(){for(var n=arguments,e=t.length-1;e>=0;e--)n=[t[e].apply(this,n)];return n[0]}},uniqueArray:function(t){for(var n={},e=[],i=0,o=t.length;o>i;++i)n.hasOwnProperty(t[i])||(e.push(t[i]),n[t[i]]=1);return e},debounce:function(t,e,i){"number"!=typeof e&&(e=n);var o,r;return function(){var n=this,s=arguments,a=function(){o=null,i||(r=t.apply(n,s))},c=i&&!o;return clearTimeout(o),o=setTimeout(a,e),c&&(r=t.apply(n,s)),r}},throttle:function(t,e){"number"!=typeof e&&(e=n);var i,o,r,s,a,c,u=this.debounce(function(){a=s=!1},e);return function(){i=this,o=arguments;var n=function(){r=null,a&&(c=t.apply(i,o)),u()};return r||(r=setTimeout(n,e)),s?a=!0:(s=!0,c=t.apply(i,o)),u(),c}},countThen:function(t,n){return function(){return--t?void 0:n.apply(this,arguments)}},delegate:function(t){return function(n,e){var i,o=$(n.target);Object.keys(t).forEach(function(r){return!n.isPropagationStopped()&&(i=o.closest(r)).length?(e=e||{},e.el=i[0],t[r].apply(this,[n,e])):void 0},this)}},once:function(t){var n,e;return function(){return n?e:(e=t.apply(this,arguments),n=!0,e)}}};return e}),n("lib/debug",[],function(){"use strict";function t(n,e,i){i=i||{};var o=i.obj||window,r=i.path||(o==window?"window":""),s=Object.keys(o);s.forEach(function(i){(p[n]||n)(e,o,i)&&console.log([r,".",i].join(""),"->",["(",typeof o[i],")"].join(""),o[i]),"[object Object]"==Object.prototype.toString.call(o[i])&&o[i]!=o&&-1==r.split(".").indexOf(i)&&t(n,e,{obj:o[i],path:[r,i].join(".")})})}function n(n,e,i,o){e&&typeof i!=e?console.error([i,"must be",e].join(" ")):t(n,i,o)}function e(t,e){n("name","string",t,e)}function i(t,e){n("nameContains","string",t,e)}function o(t,e){n("type","function",t,e)}function r(t,e){n("value",null,t,e)}function s(t,e){n("valueCoerced",null,t,e)}function a(n,e){t(n,null,e)}function c(){var t=[].slice.call(arguments);y.eventNames.length||(y.eventNames=g),y.actions=t.length?t:g,h()}function u(){var t=[].slice.call(arguments);y.actions.length||(y.actions=g),y.eventNames=t.length?t:g,h()}function f(){y.actions=[],y.eventNames=[],h()}function l(){y.actions=g,y.eventNames=g,h()}function h(){window.localStorage&&(localStorage.setItem("logFilter_eventNames",y.eventNames),localStorage.setItem("logFilter_actions",y.actions))}function d(){var t={eventNames:window.localStorage&&localStorage.getItem("logFilter_eventNames")||m,actions:window.localStorage&&localStorage.getItem("logFilter_actions")||v};return Object.keys(t).forEach(function(n){var e=t[n];"string"==typeof e&&e!==g&&(t[n]=e.split(","))}),t}var p={name:function(t,n,e){return t==e},nameContains:function(t,n,e){return e.indexOf(t)>-1},type:function(t,n,e){return n[e]instanceof t},value:function(t,n,e){return n[e]===t},valueCoerced:function(t,n,e){return n[e]==t}},g="all",m=[],v=[],y=d();return{enable:function(t){this.enabled=!!t,t&&window.console&&(console.info("Booting in DEBUG mode"),console.info("You can configure event logging with DEBUG.events.logAll()/logNone()/logByName()/logByAction()")),window.DEBUG=this},find:{byName:e,byNameContains:i,byType:o,byValue:r,byValueCoerced:s,custom:a},events:{logFilter:y,logByAction:c,logByName:u,logAll:l,logNone:f}}}),n("lib/compose",["./utils","./debug"],function(t,n){"use strict";function e(t,n){if(r){var e=Object.create(null);Object.keys(t).forEach(function(i){if(s.indexOf(i)<0){var o=Object.getOwnPropertyDescriptor(t,i);o.writable=n,e[i]=o}}),Object.defineProperties(t,e)}}function i(t,n,e){var i;return r&&t.hasOwnProperty(n)?(i=Object.getOwnPropertyDescriptor(t,n).writable,Object.defineProperty(t,n,{writable:!0}),e.call(t),Object.defineProperty(t,n,{writable:i}),void 0):(e.call(t),void 0)}function o(t,n){t.mixedIn=t.hasOwnProperty("mixedIn")?t.mixedIn:[],n.forEach(function(n){-1==t.mixedIn.indexOf(n)&&(e(t,!1),n.call(t),t.mixedIn.push(n))}),e(t,!0)}var r=n.enabled&&!t.isEnumerable(Object,"getOwnPropertyDescriptor"),s=["mixedIn"];if(r)try{Object.getOwnPropertyDescriptor(Object,"keys")}catch(a){r=!1}return{mixin:o,unlockProperty:i}}),n("lib/advice",["./compose"],function(t){"use strict";var n={around:function(t,n){return function(){var e=0,i=arguments.length,o=new Array(i+1);for(o[0]=t.bind(this);i>e;e++)o[e+1]=arguments[e];return n.apply(this,o)}},before:function(t,n){var e="function"==typeof n?n:n.obj[n.fnName];return function(){return e.apply(this,arguments),t.apply(this,arguments)}},after:function(t,n){var e="function"==typeof n?n:n.obj[n.fnName];return function(){var n=(t.unbound||t).apply(this,arguments);return e.apply(this,arguments),n}},withAdvice:function(){["before","after","around"].forEach(function(e){this[e]=function(i,o){t.unlockProperty(this,i,function(){return this[i]="function"==typeof this[i]?n[e](this[i],o):o,this[i]})}},this)}};return n}),n("lib/registry",[],function(){"use strict";function t(t,n){var e,i,o,r=n.length;return"function"==typeof n[r-1]&&(r-=1,o=n[r]),"object"==typeof n[r-1]&&(r-=1),2==r?(e=n[0],i=n[1]):(e=t.node,i=n[0]),{element:e,type:i,callback:o}}function n(t,n){return t.element==n.element&&t.type==n.type&&(null==n.callback||t.callback==n.callback)}function e(){function e(t){this.component=t,this.attachedTo=[],this.instances={},this.addInstance=function(t){var n=new i(t);return this.instances[t.identity]=n,this.attachedTo.push(t.node),n},this.removeInstance=function(t){delete this.instances[t.identity];var n=this.attachedTo.indexOf(t.node);n>-1&&this.attachedTo.splice(n,1),Object.keys(this.instances).length||o.removeComponentInfo(this)},this.isAttachedTo=function(t){return this.attachedTo.indexOf(t)>-1}}function i(t){this.instance=t,this.events=[],this.addBind=function(t){this.events.push(t),o.events.push(t)},this.removeBind=function(t){for(var e,i=0;e=this.events[i];i++)n(e,t)&&this.events.splice(i,1)}}var o=this;(this.reset=function(){this.components=[],this.allInstances={},this.events=[]}).call(this),this.addInstance=function(t){var n=this.findComponentInfo(t);n||(n=new e(t.constructor),this.components.push(n));var i=n.addInstance(t);return this.allInstances[t.identity]=i,n},this.removeInstance=function(t){this.findInstanceInfo(t);var n=this.findComponentInfo(t);n&&n.removeInstance(t),delete this.allInstances[t.identity]},this.removeComponentInfo=function(t){var n=this.components.indexOf(t);n>-1&&this.components.splice(n,1)},this.findComponentInfo=function(t){for(var n,e=t.attachTo?t:t.constructor,i=0;n=this.components[i];i++)if(n.component===e)return n;return null},this.findInstanceInfo=function(t){return this.allInstances[t.identity]||null},this.findInstanceInfoByNode=function(t){var n=[];return Object.keys(this.allInstances).forEach(function(e){var i=this.allInstances[e];i.instance.node===t&&n.push(i)},this),n},this.on=function(n){for(var e,i=o.findInstanceInfo(this),r=arguments.length,s=1,a=new Array(r-1);r>s;s++)a[s-1]=arguments[s];if(i){e=n.apply(null,a),e&&(a[a.length-1]=e);var c=t(this,a);i.addBind(c)}},this.off=function(){var e=t(this,arguments),i=o.findInstanceInfo(this);i&&i.removeBind(e);for(var r,s=0;r=o.events[s];s++)n(r,e)&&o.events.splice(s,1)},o.trigger=function(){},this.teardown=function(){o.removeInstance(this)},this.withRegistration=function(){this.after("initialize",function(){o.addInstance(this)}),this.around("on",o.on),this.after("off",o.off),window.DEBUG&&DEBUG.enabled&&this.after("trigger",o.trigger),this.after("teardown",{obj:o,fnName:"teardown"})}}return new e}),n("lib/base",["./utils","./registry","./debug"],function(t,n,e){"use strict";function i(t){t.events.slice().forEach(function(t){var n=[t.type];t.element&&n.unshift(t.element),"function"==typeof t.callback&&n.push(t.callback),this.off.apply(this,n)},t.instance)}function o(t,n){try{window.postMessage(n,"*")}catch(e){throw console.log("unserializable data for event",t,":",n),new Error(["The event",t,"on component",this.toString(),"was triggered with non-serializable data"].join(" "))}}function r(){this.trigger=function(){var t,n,i,r,s,a=arguments.length-1,c=arguments[a];return"string"==typeof c||c&&c.defaultBehavior||(a--,i=c),1==a?(t=$(arguments[0]),r=arguments[1]):(t=this.$node,r=arguments[0]),r.defaultBehavior&&(s=r.defaultBehavior,r=$.Event(r.type)),n=r.type||r,e.enabled&&window.postMessage&&o.call(this,n,i),"object"==typeof this.attr.eventData&&(i=$.extend(!0,{},this.attr.eventData,i)),t.trigger(r||n,i),s&&!r.isDefaultPrevented()&&(this[s]||s).call(this),t},this.on=function(){var n,e,i,o,r=arguments.length-1,s=arguments[r];if(o="object"==typeof s?t.delegate(this.resolveDelegateRules(s)):s,2==r?(n=$(arguments[0]),e=arguments[1]):(n=this.$node,e=arguments[0]),"function"!=typeof o&&"object"!=typeof o)throw new Error('Unable to bind to "'+e+'" because the given callback is not a function or an object');return i=o.bind(this),i.target=o,i.context=this,n.on(e,i),o.bound||(o.bound=[]),o.bound.push(i),i},this.off=function(){var t,n,e,i=arguments.length-1;return"function"==typeof arguments[i]&&(e=arguments[i],i-=1),1==i?(t=$(arguments[0]),n=arguments[1]):(t=this.$node,n=arguments[0]),e&&e.bound&&e.bound.some(function(t,n,i){return t.context&&this.identity==t.context.identity?(i.splice(n,1),e=t,!0):void 0},this),t.off(n,e)},this.resolveDelegateRules=function(t){var n={};return Object.keys(t).forEach(function(e){if(!(e in this.attr))throw new Error('Component "'+this.toString()+'" wants to listen on "'+e+'" but no such attribute was defined.');n[this.attr[e]]=t[e]},this),n},this.defaultAttrs=function(n){t.push(this.defaults,n,!0)||(this.defaults=n)},this.select=function(t){return this.$node.find(this.attr[t])},this.initialize=function(t,n){if(n||(n={}),this.identity||(this.identity=s++),!t)throw new Error("Component needs a node");t.jquery?(this.node=t[0],this.$node=t):(this.node=t,this.$node=$(t));var e=Object.create(n);for(var i in this.defaults)n.hasOwnProperty(i)||(e[i]=this.defaults[i]);return this.attr=e,Object.keys(this.defaults||{}).forEach(function(t){if(null===this.defaults[t]&&null===this.attr[t])throw new Error('Required attribute "'+t+'" not specified in attachTo for component "'+this.toString()+'".')},this),this},this.teardown=function(){i(n.findInstanceInfo(this))}}var s=0;return r}),n("lib/logger",["./utils"],function(t){"use strict";function n(t){var n=t.tagName?t.tagName.toLowerCase():t.toString(),e=t.className?"."+t.className:"",i=n+e;return t.tagName?["'","'"].join(i):i}function e(t,e,i){if(window.DEBUG&&window.DEBUG.enabled){var r,s,a,c,u,f,l,h;"function"==typeof i[i.length-1]&&(c=i.pop(),c=c.unbound||c),1==i.length?(a=e.$node[0],s=i[0]):2==i.length?"object"!=typeof i[1]||i[1].type?(a=i[0],s=i[1]):(a=e.$node[0],s=i[0]):(a=i[0],s=i[1]),r="object"==typeof s?s.type:s,u=DEBUG.events.logFilter,l="all"==u.actions||u.actions.indexOf(t)>-1,f=function(t){return t.test?t:new RegExp("^"+t.replace(/\*/g,".*")+"$")},h="all"==u.eventNames||u.eventNames.some(function(t){return f(t).test(r)}),l&&h&&console.info(o[t],t,"["+r+"]",n(a),e.constructor.describe.split(" ").slice(0,3).join(" "))}}function i(){this.before("trigger",function(){e("trigger",this,t.toArray(arguments))}),this.before("on",function(){e("on",this,t.toArray(arguments))}),this.before("off",function(){e("off",this,t.toArray(arguments))})}var o={on:"<-",trigger:"->",off:"x "};return i}),n("lib/component",["./advice","./utils","./compose","./base","./registry","./logger","./debug"],function(t,n,e,i,o,r,s){"use strict";function a(){var t=o.findComponentInfo(this);t&&Object.keys(t.instances).forEach(function(n){var e=t.instances[n];e&&e.instance&&e.instance.teardown()})}function c(t){for(var e=arguments.length,i=new Array(e-1),r=1;e>r;r++)i[r-1]=arguments[r];if(!t)throw new Error("Component needs to be attachTo'd a jQuery object, native node or selector string");var s=n.merge.apply(n,i),a=o.findComponentInfo(this);$(t).each(function(t,n){a&&a.isAttachedTo(n)||(new this).initialize(n,s)}.bind(this))}function u(){for(var n=arguments.length,u=new Array(n+3),l=0;n>l;l++)u[l]=arguments[l];var h=function(){};return h.toString=h.prototype.toString=function(){var t=u.map(function(t){if(null==t.name){var n=t.toString().match(f);return n&&n[1]?n[1]:""}return"withBase"!=t.name?t.name:""}).filter(Boolean).join(", ");return t},s.enabled&&(h.describe=h.prototype.describe=h.toString()),h.attachTo=c,h.teardownAll=a,s.enabled&&u.unshift(r),u.unshift(i,t.withAdvice,o.withRegistration),e.mixin(h.prototype,u),h}var f=/function (.*?)\s?\(/;return u.teardownAll=function(){o.components.slice().forEach(function(t){t.component.teardownAll()}),o.reset()},u}),n("lib/index",["./advice","./component","./compose","./logger","./registry","./utils"],function(t,n,e,i,o,r){"use strict";return{advice:t,component:n,compose:e,logger:i,registry:o,utils:r}}),t.flight=e("lib/index")}(this);
